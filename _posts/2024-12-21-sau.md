---
title: "Sau"
date: 2024-12-21
categories: HTB
tags: ["htb walkthrough", "ctf", "cybersecurity", "hackthebox", "htb writeup", "penetration testing", "sau", "writeup", "htb"]
---

# Sau

# Sau

# Enumeration
- :55555/web
- CVE-2023-27163
- Maltrail v0.53

![[Pasted image 20240827135329.png]]

## 55555-TCP
# Notes
- Request-baskets v1.2.1
# Fuzzing
![[Pasted image 20240827124554.png]]

# Screenshots
![[Pasted image 20240827134722.png]]

```text
O2ZJG8S00yexG8xe_5Z0zwH0Hu53MF9SMpULkgOyK6eI
```

![[Pasted image 20240827134904.png]]

# SSRF
https://github.com/rvizx/CVE-2023-27163

![[Pasted image 20240827140613.png]]

![[Pasted image 20240827140629.png]]

```sh
# URL encode this
curl "http://10.10.11.224:55555/8gvphln?
cmd=c:\users\public\shell.sh"
```

https://github.com/entr0pie/CVE-2023-27163


# Foothold
- Changing the configuration settings in `:55555/web/<basket>` as below and navigation to the basket on a web browser shows the vulnerable service name and version. 

![[/assets/images/sau4.png]]
![[/assets/images/sau5.png]]

## Notes
- CVE-2023-27163
## Attempts
https://github.com/entr0pie/CVE-2023-27163

Add attacker URL to `Forward URL:`
![[/assets/images/sau1.png]]

Try to send the `GET` request to the basket and see if I receive anything on *Netcat* listener.
![[/assets/images/sau2.png]]

![[/assets/images/sau3.png]]

![[/assets/images/sau4.png]]

Access the basket in a browser http://10.10.11.224:55555/rkh5ump
![[/assets/images/sau5.png]]

# Maltrail v0.53
https://github.com/spookier/Maltrail-v0.53-Exploit

![[/assets/images/sau7.png]]

![[/assets/images/sau6.png]]


# Privilege Escalation
- `sudo -l` shows that `/usr/bin/systemctl status trail.service` can be run without a password. 
- `systemctl --version` shows the vulnerable version.
- Used a public exploit to gain root access. 

![[/assets/images/sau9.png]]

![[/assets/images/sau11.png]]
- systemd 245

https://packetstormsecurity.com/files/174130/systemd-246-Local-Root-Privilege-Escalation.html

# PoC
```text
1. Run the systemctl command which can be run as root user.

sudo /usr/bin/systemctl status any_service

2. The ouput is opened in a pager (less) which allows us to execute arbitrary commands.

3. Type in `!/bin/sh` in the pager to spawn a shell as root user.
```

![[/assets/images/sau13.png]]


