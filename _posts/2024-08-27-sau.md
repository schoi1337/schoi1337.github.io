---
title: "Sau"
date: 2024-08-27
categories: HTB
tags: ["ctf", "penetration testing", "htb", "cybersecurity", "htb writeup", "htb walkthrough", "hackthebox", "sau", "writeup"]
---

## Enumeration

> - :55555/web
- CVE-2023-27163
- Maltrail v0.53



### 80-HTTP

#### Gobuster

![screenshot](/assets/images/sau1.png)

### 55555-TCP

![screenshot](/assets/images/sau16.png)

### Web

![screenshot](/assets/images/sau17.png)

![screenshot](/assets/images/sau18.png)

## Foothold

### SSRF

[Public exploit used](https://github.com/entr0pie/CVE-2023-27163)

Add attacker URL to `Forward URL:`

![screenshot](/assets/images/sau21.png)

Send the `GET` request to the basket and see if I receive anything on the *Netcat* listener.

![screenshot](/assets/images/sau22.png)

![screenshot](/assets/images/sau23.png)

![screenshot](/assets/images/sau24.png)

Access the basket in a browser http://10.10.11.224:55555/rkh5ump

![screenshot](/assets/images/sau25.png)

### Maltrail v0.53

[Public exploit used](https://github.com/spookier/Maltrail-v0.53-Exploit)

![screenshot](/assets/images/sau7.png)

![screenshot](/assets/images/sau6.png)

## Privilege Escalation

>- `sudo -l` shows that `/usr/bin/systemctl status trail.service` can be run without a password. 
- `systemctl --version` shows the vulnerable version.
- Used a public exploit to gain root access. 

![screenshot](/assets/images/sau9.png)

![screenshot](/assets/images/sau11.png)

systemd 245

### PoC

[PoC used](https://packetstormsecurity.com/files/174130/systemd-246-Local-Root-Privilege-Escalation.html)

```text
1. Run the systemctl command which can be run as root user.

sudo /usr/bin/systemctl status any_service

2. The ouput is opened in a pager (less) which allows us to execute arbitrary commands.

3. Type in `!/bin/sh` in the pager to spawn a shell as root user.
```

![screenshot](/assets/images/sau13.png)


