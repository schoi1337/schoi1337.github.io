---
title: "Netmon"
date: 2024-11-05
categories: HTB
tags: ["htb walkthrough", "ctf", "cybersecurity", "hackthebox", "htb writeup", "penetration testing", "netmon", "writeup", "htb"]
---

# Netmon

# Credentials
| Username  | Password      | Hash | Source |
| --------- | ------------- | ---- | ------ |
| prtgadmin | PrTg@dmin2019 |      |        |
|           |               |      |        |
|           |               |      |        |
# Notes
- PRTG Network Monitor 18.1.37.13946
# Enumeration
- Googling default configuration file for the PRTG Network Monitor gives its location
- FTP to download the config archive where it contains old password
- Changing `PrTg@dmin2018` to `PrTg@dmin2019` provides access to the dashboard.
- Public exploit to RCE.
- No PE

## Nmap
# TCP
```sh
PORT      STATE SERVICE      REASON  VERSION
21/tcp    open  ftp          syn-ack Microsoft ftpd
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
| 02-03-19  12:18AM                 1024 .rnd
| 02-25-19  10:15PM       <DIR>          inetpub
| 07-16-16  09:18AM       <DIR>          PerfLogs
| 02-25-19  10:56PM       <DIR>          Program Files
| 02-03-19  12:28AM       <DIR>          Program Files (x86)
| 02-03-19  08:08AM       <DIR>          Users
|_11-10-23  10:20AM       <DIR>          Windows
| ftp-syst: 
|_  SYST: Windows_NT
80/tcp    open  http         syn-ack Indy httpd 18.1.37.13946 (Paessler PRTG bandwidth monitor)
|_http-server-header: PRTG/18.1.37.13946
|_http-favicon: Unknown favicon MD5: 36B3EF286FA4BEFBB797A0966B456479
|_http-trane-info: Problem with XML parsing of /evox/about
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
| http-title: Welcome | PRTG Network Monitor (NETMON)
|_Requested resource was /index.htm
135/tcp   open  msrpc        syn-ack Microsoft Windows RPC
139/tcp   open  netbios-ssn  syn-ack Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds syn-ack Microsoft Windows Server 2008 R2 - 2012 microsoft-ds
5985/tcp  open  http         syn-ack Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
47001/tcp open  http         syn-ack Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-title: Not Found
|_http-server-header: Microsoft-HTTPAPI/2.0
49664/tcp open  msrpc        syn-ack Microsoft Windows RPC
49665/tcp open  msrpc        syn-ack Microsoft Windows RPC
49666/tcp open  msrpc        syn-ack Microsoft Windows RPC
49667/tcp open  msrpc        syn-ack Microsoft Windows RPC
49668/tcp open  msrpc        syn-ack Microsoft Windows RPC
49669/tcp open  msrpc        syn-ack Microsoft Windows RPC
Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows

```

# UDP
```sh
PORT      STATE         SERVICE      VERSION
53/udp    open|filtered domain
67/udp    open|filtered dhcps
68/udp    open|filtered dhcpc
69/udp    open|filtered tftp
123/udp   open|filtered ntp
135/udp   open|filtered msrpc
137/udp   open|filtered netbios-ns
138/udp   open|filtered netbios-dgm
139/udp   open|filtered netbios-ssn
161/udp   closed        snmp
162/udp   open|filtered snmptrap
445/udp   open|filtered microsoft-ds
500/udp   open|filtered isakmp
514/udp   open|filtered syslog
520/udp   open|filtered route
631/udp   open|filtered ipp
1434/udp  open|filtered ms-sql-m
1900/udp  open|filtered upnp
4500/udp  open|filtered nat-t-ike
49152/udp open|filtered unknown
```


## FTP
ftp-anon: Anonymous FTP login allowed (FTP code 230)
	1024 .rnd
	<DIR>          inetpub
	<DIR>          PerfLogs
	<DIR>          Program Files
	<DIR>          Program Files (x86)
	<DIR>          Users
	<DIR>          Windows

![[/assets/images/netmon7.png]]


![[/assets/images/netmon6.png]]

```sh
# old password from archive
prtgadmin : PrTg@dmin2018
# current password
prtgadmin : PrTg@dmin2019
```

![[/assets/images/netmon8.png]]

## 80-HTTP
# Directory Fuzzing
## Gobuster
```sh

```


# Screenshots
http://10.10.10.152/index.htm
![[/assets/images/netmon1.png]]

`admin : admin`, `prtgadmin : prtgadmin` didn't work

![[/assets/images/netmon4.png]]
![[/assets/images/netmon3.png]]

## MSRPC
![[/assets/images/netmon5.png]]

## SMB
![[/assets/images/netmon2.png]]

# Foohtold
https://github.com/A1vinSmith/CVE-2018-9276

![[/assets/images/netmon9.png]]
![[/assets/images/netmon10.png]]

